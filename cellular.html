<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cellular Automaton</title>
    <style type="text/css">


* {
  box-sizing: border-box;
}
table {
  display: inline;
  border-collapse: collapse;
}
div.control {
  display: inline-block;
  width: 30px;
  text-align: center
}
div.border {
  display: inline-block;
  float: left;
}
div.border, td.border {
  width: 10px;
  height: 10px;
  border: 1px solid black;
}

div.border.black, td.border.black {
  background: black;
}

div.border.white, td.border.white {
  background: white;
}


    </style>
    <script type="application/javascript">


function init() {
  // rule 30 https://en.wikipedia.org/wiki/Rule_30
  var rule = 30;

  // rule 90 https://en.wikipedia.org/wiki/Rule_90
  // var rule = 90;

  // rule 110 https://en.wikipedia.org/wiki/Rule_110
  // var rule = 110;

  var checkboxElements = document.querySelectorAll('#controls input');
  for(var i = 0; i < 8; ++i) {
    var checked = !!(rule & (1 << i));
    checkboxElements[7 - i].checked = checked ? 'checked' : '';
  }
}

function draw() {
  var canvas = document.getElementById('canvas');

  if (canvas.getContext) {
    var ctx = canvas.getContext('2d');
    
    var checkboxElements = document.querySelectorAll('#controls input');
    var r = [];
    for (var i = 0; i < checkboxElements.length; i++) {
      r[i] = checkboxElements[i].checked;
    }

    var white = 0xffffffff;
    var black = 0xff000000;
    var colors = [
      0xFFFF00FF, // fuchsia
      0xFF0000FF, // red
      0xFF00A5FF, // orange
      0xFF00FFFF, // yellow
      0xFF008000, // green
      0xFFFF901E, // dodgerblue
      0xFF800000, // navy
      0xFF800080, // purple
    ];

    var outImageData = ctx.createImageData(canvas.width, 1);
    var outPixels = new Uint32Array(outImageData.data.buffer);

    // initialize canvas with single black pixel in the middle of the first row
    for(var x = 0; x < canvas.width; x++) {
      var color = white;
      if(x == Math.floor(canvas.width / 2)) {
        color = black;
      }
      outPixels[x] = color;
    }
    ctx.putImageData(outImageData, 0, 0);

    for(var y = 0; y < canvas.height; y++) {
      var inImageData = ctx.getImageData(0, y, canvas.width, 1);
      var inPixels = new Uint32Array(inImageData.data.buffer);

      for(var x = 1; x < canvas.width-1; x++) {

        var prevPixel = inPixels[x - 1];
        var currPixel = inPixels[x];
        var nextPixel = inPixels[x + 1];
        
        var prevBit = (prevPixel == white) ? 1 : 0;
        var currBit = (currPixel == white) ? 1 : 0;
        var nextBit = (nextPixel == white) ? 1 : 0;

        var colorIndex = prevBit << 2 | currBit << 1 | nextBit << 0;
        var color = r[colorIndex] ? colors[colorIndex] : white;

        outPixels[x] = color;
      }

      ctx.putImageData(outImageData, 0, y + 1);
    }

  }
}


    </script>
  </head>
  <body onload="init();draw();">
    <div id="controls">
      <div class="control">
        <div class="border black"></div>
        <div class="border black"></div>
        <div class="border black"></div>
        <input type="checkbox" onclick="draw();" />
      </div>

      <div class="control">
        <div class="border black"></div>
        <div class="border black"></div>
        <div class="border white"></div>
        <input type="checkbox" onclick="draw();" />
      </div>

      <div class="control">
        <div class="border black"></div>
        <div class="border white"></div>
        <div class="border black"></div>
        <input type="checkbox" onclick="draw();" />
      </div>


      <div class="control">
        <div class="border black"></div>
        <div class="border white"></div>
        <div class="border white"></div>
        <input type="checkbox" onclick="draw();" />
      </div>


      <div class="control">
        <div class="border white"></div>
        <div class="border black"></div>
        <div class="border black"></div>
        <input type="checkbox" onclick="draw();" />
      </div>


      <div class="control">
        <div class="border white"></div>
        <div class="border black"></div>
        <div class="border white"></div>
        <input type="checkbox" onclick="draw();" />
      </div>


      <div class="control">
        <div class="border white"></div>
        <div class="border white"></div>
        <div class="border black"></div>
        <input type="checkbox" onclick="draw();" />
      </div>


      <div class="control">
        <div class="border white"></div>
        <div class="border white"></div>
        <div class="border white"></div>
        <input type="checkbox" onclick="draw();" />
      </div>
    </div>

    <canvas id="canvas" width="1000" height="500"></canvas>
    </body>
 </html>
